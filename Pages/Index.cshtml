@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
    Layout = "_LayoutMain";
}
@{

    List<object> toolbarItems = new List<object>();
    toolbarItems.Add("ExcelExport");
    toolbarItems.Add(new { text = "Reset Layout", tooltipText = "Reset Layout", prefixIcon = "e-reset", id = "GridLeave_resetlayout", align = "Right" });
    toolbarItems.Add(new { text = "Clear Filters", tooltipText = "Clear Filters", prefixIcon = "e-filter-clear", id = "GridLeave_clearfilters", align = "Right" });
    toolbarItems.Add("ColumnChooser");
    toolbarItems.Add("Search");
    List<string> StateList = new List<string> { "Gujarat", "Maharashtra", "Rajasthan" };
    List<string> CountryList = new List<string> { "Canada", "India", "United States" };
    List<string> MaritalStatusList = new List<string> { "Single", "Married",  "Divorced"};
    List<string> AppointmentWith = new List<string> { "Dr. Sejal Saheta", "Dr. Jane Doe", "Dr. John Doe" };
    List<string> FormofAppointment = new List<string> { "Inclinic", "Online" };
}
@Html.AntiForgeryToken()
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Portal</title>

    <link rel="stylesheet" href="~/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/custom.css">
    <link rel="stylesheet" href="~/css/responsive.css">

    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet">

</head>
<body>
    <main class="page">
        <div class="container container-x">
            <h1 class="page-title text-28">Patient Portal</h1>

            <div class="ius-block ius-card">
                <h2>Patient Information</h2>

                <form class="ius-form" action="#" method="POST">
                    <input type="hidden" id="PatientId" asp-for="PatientData.Id" name="medicalPatientSignature" class="custom-field-height" />
                    <div class="row">
                        <div class="col-md-6 col-xl-4">
                            <label for="pi-name" class="form-label">Name</label>
                            <input type="text" name="patientname" asp-for="PatientData.Name" class="form-control" id="pi-name">
                            <span asp-validation-for="PatientData.Name" class="text-danger"></span>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-phoneno" class="form-label">Phone Number</label>
                            <input type="text" name="phoneno" asp-for="PatientData.Mobile" class="form-control" id="pi-phoneno"  disabled>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-email" class="form-label">Email Id</label>
                            <input type="email" name="email" asp-for="PatientData.Email" class="form-control" id="pi-email" >
                            <span asp-validation-for="PatientData.Email" class="text-danger"></span>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-age" class="form-label">Age</label>
                            <input type="number" name="age" asp-for="PatientData.Age" maxlength="2" class="form-control" id="pi-age" >
                            <span asp-validation-for="PatientData.Age" class="text-danger"></span>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-dob" class="form-label">Date of Birth</label>
                            @* <input type="date" name="dob" class="form-control form-date" id="pi-dob" value="1995-09-03"> *@
                            <ejs-datepicker id="pi-dob" ejs-for="PatientData.Dob" class="form-control" format="dd/MM/yyyy" style="height: 45px;"></ejs-datepicker>
                            <span asp-validation-for="PatientData.Dob" class="text-danger"></span>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label class="form-label">Gender</label>

                            <div class="btn-group" role="group">
                                <input type="radio" class="btn-check" name="gender" id="gender-male">
                                <label class="btn" for="gender-male">Male</label>

                                <input type="radio" class="btn-check" name="gender" id="gender-female">
                                <label class="btn" for="gender-female">Female</label>

                                <input type="radio" class="btn-check" name="gender" id="gender-other">
                                <label class="btn" for="gender-other">Other</label>
                            </div>

                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-matstat" class="form-label">Marital Status</label>
                            <ejs-dropdownlist Id="pi-matstat" ejs-for="PatientData.MaritalStatus" class="form-control" TValue="string" DataSource="MaritalStatusList" Placeholder="Select Marital Status"></ejs-dropdownlist>
                            <span asp-validation-for="PatientData.MaritalStatus" class="text-danger"></span>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-pincode" class="form-label">Pincode</label>
                            <input type="number" name="pincode" id="pi-pincode" asp-for="PatientData.Pincode" class="form-control" readonly>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-locality" class="form-label">Locality</label>
                            <input type="text" name="locality" id="pi-locality" asp-for="PatientData.Locality" class="form-control" readonly>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-address" class="form-label">Address</label>
                            <input type="text" name="address" asp-for="PatientData.Address" id="pi-address" class="form-control" readonly>
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-city" class="form-label">City</label>
                            <input type="text" id="pi-city" class="form-control" name="city" asp-for="PatientData.CityName"  readonly>

                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-state" class="form-label">State</label>
                            <input type="text" id="pi-state" class="form-control" name="state" asp-for="PatientData.StateName" readonly>

                           @*  <ejs-dropdownlist ID="pi-state" class="form-control"  TValue="string" DataSource="StateList" Placeholder="Select State"></ejs-dropdownlist>
 *@
                        </div>

                        <div class="col-md-6 col-xl-4">
                            <label for="pi-country" class="form-label">Country</label>
                            <input type="text" id="pi-country" class="form-control" name="Country" asp-for="PatientData.CountryName" readonly>
                        </div>
                    </div>

                    <div class="form-actions">
                        <a href="#" class="bttn bttn-primary" id="edit-btn" title="Edit">Edit</a>
                        <a href="#" class="bttn bttn-primary-outline" id="cancel-btn" title="Cancel" disabled>Cancel</a>
                        <a href="#" class="bttn bttn-primary" id="save-btn" title="Save" disabled>Save</a>

                    </div>
                </form>
            </div>
            @if (Model.ChangeRequests.Count > 0 && Model.ChangeRequests != null )
            {
                <div class="ius-block ius-card ius-notes">
                    <h2 class="mb-2 pb-1 text--red">Changes Requested</h2>
                    <ol>
                        @foreach (var change in Model.ChangeRequests)
                        {
                            <li>@change</li>
                        }
                    </ol>
                </div>

            }
                <div class="ius-block ius-card ius-notes">
                    <h2 class="mb-2 pb-1 text--red">Notes</h2>
                <ol>
                    <li>Appt will be booked for consultation with Dr. Sejal Saheta.</li>
                    <li>For an appointment with an aesthetician for cosmetic procedures please call Clinic - <a href="tel:+91-9639639630" title="91-9639639630">9639639630</a></li>
                </ol>
            </div>
            
            <div class="ius-block ius-card ius-appdata">
                <div class="ius-block-head">
                    <h2>Appointment Grid</h2>

                    <div class="ius-grid-filters">
                        <a class="bttn-add" href="#app-add" data-bs-toggle="modal" data-bs-target="#app-add" title="Add Appointment">
                            <img loading="lazy" src="~/assets/plus.svg" width="19" height="19" alt="Add">
                        </a>
                    </div>
                </div>

                <!-- Only for desktop : Syncfusion -->
                <div class="ius-table d-none d-lg-block table-responsive">
                        <ejs-grid id="GridAppointments"
                                  allowResizing="true"
                                  allowExcelExport="true"
                              allowFiltering="true"
                                  allowPaging="true"
                                  allowSorting="true"
                                  allowSelection="true"
                                  allowReordering="true"
                                  enableHeaderFocus="true"
                                  enablePersistence="true"
                                  enableHover="true"
                                  autoFit="true"
                                  height="200"
                                  showColumnChooser="true"
                                  rowHeight="38"
                                  toolbar=toolbarItems
                                  toolbarClick="toolbarClick">

                            <e-data-manager url="/Index?handler=AppointmentView" adaptor="UrlAdaptor" crossDomain="true"></e-data-manager>

                            <e-grid-searchsettings fields="@(new string[] {"AppointmentType","DoctorName","FormOfAppointment","AppointmentDateTime","Status"})"></e-grid-searchsettings>

                            <e-grid-filtersettings type="Excel"></e-grid-filtersettings>
                            <e-grid-loadingIndicator indicatorType="Shimmer"></e-grid-loadingIndicator>
                            <e-grid-pagesettings pageCount="15" pageSize="15" pageSizes="@(new string[] { "All","12","15","25","50"})"></e-grid-pagesettings>
                            <e-grid-selectionsettings type="Single"></e-grid-selectionsettings>

                            <e-grid-columns>
                                 <e-grid-column field="AppointmentType" headerText="Type of Appointment" width="200"></e-grid-column>
                                <e-grid-column field="DoctorName" headerText="Appointment With" width="200"></e-grid-column>
                                <e-grid-column field="FormOfAppointment" headerText="Form of Appointment" width="200"></e-grid-column>
                                <e-grid-column field="AppointmentDateTime" headerText="Appointment Date Time" type="dateTime" width="200"></e-grid-column>
                                <e-grid-column field="Status" headerText="Status" width="150"></e-grid-column>
                            </e-grid-columns>
                        </ejs-grid>

                  

                </div>


                <!-- Only for mobile : Syncfusion -->
                <div class="ius-grid d-lg-none text-14" id="appointments-container">
                    <div class="ius-gridrow">
                        <div class="ius-appbody">
                            <div class="ius-appinfo">
                                <h3>Dr. Sejal Saheta</h3>
                                <div class="ius-apptyfo">
                                    <span class="appinfo-type">Consultation</span>
                                    <span class="appinfo-dot"></span>
                                    <span class="appinfo-form">Inclinic</span>
                                </div>
                            </div>
                            <div class="ius-ctrls">
                                <a href="#app-resched" class="app-resched" title="Reschedule" data-bs-toggle="modal" data-bs-target="#app-resched">
                                    <img loading="lazy" src="~/assets/calendar.svg" width="18" height="20" alt="Calendar">
                                </a>
                                <a href="#app-cancel" title="Cancel" data-bs-toggle="modal" data-bs-target="#app-cancel">
                                    <img loading="lazy" src="~/assets/delete.svg" width="18" height="20" alt="Cancel">
                                </a>
                            </div>
                        </div>
                        <div class="ius-foo">
                            <div class="ius-datetime">
                                <div class="datetime-label text-sb">Date & Time</div>
                                <div>1/3/2025 12:10:00</div>
                            </div>

                            <div class="ius-status">
                                <div class="ius-badge">Schedule</div>
                            </div>
                        </div>
                    </div>

                    <div class="ius-gridrow">
                        <div class="ius-appbody">
                            <div class="ius-appinfo">
                                <h3>Dr. Sejal Saheta</h3>
                                <div class="ius-apptyfo">
                                    <span class="appinfo-type">Consultation</span>
                                    <span class="appinfo-dot"></span>
                                    <span class="appinfo-form">Inclinic</span>
                                </div>
                            </div>
                            <div class="ius-ctrls">
                                <a href="#app-resched" class="app-resched" title="Reschedule" data-bs-toggle="modal" data-bs-target="#app-resched">
                                    <img loading="lazy" src="~/assets/calendar.svg" width="18" height="20" alt="Calendar">
                                </a>
                                <a href="#app-cancel" title="Cancel" data-bs-toggle="modal" data-bs-target="#app-cancel">
                                    <img loading="lazy" src="~/assets/delete.svg" width="18" height="20" alt="Cancel">
                                </a>
                            </div>
                        </div>
                        <div class="ius-foo">
                            <div class="ius-datetime">
                                <div class="datetime-label text-sb">Date & Time</div>
                                <div>1/3/2025 12:10:00</div>
                            </div>

                            <div class="ius-status">
                                <div class="ius-badge badge-green">Completed</div>
                            </div>
                        </div>
                    </div>

                    <div class="ius-gridrow">
                        <div class="ius-appbody">
                            <div class="ius-appinfo">
                                <h3>Dr. Sejal Saheta</h3>
                                <div class="ius-apptyfo">
                                    <span class="appinfo-type">Consultation</span>
                                    <span class="appinfo-dot"></span>
                                    <span class="appinfo-form">Inclinic</span>
                                </div>
                            </div>
                            <div class="ius-ctrls">
                                <a href="#app-resched" class="app-resched" title="Reschedule" data-bs-toggle="modal" data-bs-target="#app-resched">
                                    <img loading="lazy" src="~/assets/calendar.svg" width="18" height="20" alt="Calendar">
                                </a>
                                <a href="#app-cancel" title="Cancel" data-bs-toggle="modal" data-bs-target="#app-cancel">
                                    <img loading="lazy" src="~/assets/delete.svg" width="18" height="20" alt="Cancel">
                                </a>
                            </div>
                        </div>
                        <div class="ius-foo">
                            <div class="ius-datetime">
                                <div class="datetime-label text-sb">Date & Time</div>
                                <div>1/3/2025 12:10:00</div>
                            </div>

                            <div class="ius-status">
                                <div class="ius-badge badge-red">Cancelled</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Cancel Appointment - Modal -->
    <div class="modal fade" id="app-cancel">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="mb-0">Cancel Appointment</h3>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="modal-icon text-center pt-3 pb-3">
                        <img src="~/assets/cancel.svg" width="80" height="80" alt="Cancel Appointment">
                    </div>

                    <p class="text-center h4 text-sb">Are you sure you want to delete this appointment?</p>
                </div>
                <div class="modal-footer border-0 justify-content-center">
                    <button type="button" class="bttn bttn-alt" data-bs-dismiss="modal">No</button>
                    <button type="button" class="bttn bttn-primary" data-bs-dismiss="modal">Yes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reschedule Appointment - Modal -->
    <div class="modal fade" id="app-resched">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="mb-0">Reschedule Appointment</h3>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="">
                        <label for="pi-resched" class="form-label">Appointment Date Time</label>
                        <input type="datetime-local" name="dob" class="form-control form-date set-datetime" id="pi-resched" value="2025-01-29T22:47">
                    </div>
                </div>
                <div class="modal-footer border-0 justify-content-center">
                    <button type="button" class="bttn bttn-primary" data-bs-dismiss="modal">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Appointment - Modal -->
    <div class="modal fade" id="app-add">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="mb-0">Add Appointment</h3>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container-fluid ius-form">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="app-type" class="form-label">Type of Appointment</label>
                                <input type="text" name="apptype" class="form-control" id="app-type" placeholder="Consultation">
                            </div>
                            <div class="col-md-6">
                                <label for="app-with" class="form-label">Appointment With</label>
                                <ejs-dropdownlist class="form-control" id="app-with" DataSource="AppointmentWith" placeholder="Select Doctor"></ejs-dropdownlist>
                            </div>
                            <div class="col-md-6">
                                <label for="app-form" class="form-label">Form of Appointment</label>
                                <ejs-dropdownlist class="form-control" id="app-form" DataSource="FormofAppointment" placeholder="Select Form"></ejs-dropdownlist>
                            </div>
                            <div class="col-md-6">
                                <label for="app-datetime" class="form-label">Appointment Date Time</label>
                                <input type="datetime-local" name="appdatetime" class="form-control set-datetime form-date" id="app-datetime" value="2025-01-29T22:47">
                            </div>
                            <div class="col-md-6">
                                <label for="app-status" class="form-label">Status</label>  @* its Remove *@
                               @*  <ejs-dropdownlist id="app-status" placeholder="Select Form"></ejs-dropdownlist> *@
                                <select class="form-select" id="app-status" name="appstatus">
                                    <option value="Inclinic">Rescheduled</option>
                                    <option value="Online">New</option>
                                    <option value="Visit">Old</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-0 justify-content-center">
                    <button type="button" class="bttn bttn-primary" data-bs-dismiss="modal">Save</button>
                </div>
            </div>
        </div>
    </div>


    <script src="./js/jquery.min.js"></script>
    <script src="./js/bootstrap.bundle.min.js"></script>
    <script src="./js/custom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>


</body>
</html>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var gender = "@Model.PatientData.Gender"; // Server se value leke aayenge

        if (gender === "Male") {
            document.getElementById("gender-male").checked = true;
        } else if (gender === "Female") {
            document.getElementById("gender-female").checked = true;
        } else if (gender === "Other") {
            document.getElementById("gender-other").checked = true;
        }
    });
</script>
<script>
    document.getElementById('pi-age').addEventListener('input', function (e) {
        let value = e.target.value;
        if (value.length > 2) {
            e.target.value = value.slice(0, 2); // Sirf 2 characters allow karega
        }
    });

    document.getElementById('pi-name').addEventListener('input', function (e) {
        let value = e.target.value;
        let regex = /^[A-Za-z\s]*$/; // Sirf characters aur space allow karega
        if (!regex.test(value)) {
            e.target.value = value.slice(0, -1); // Last invalid character hata dega
        }
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        let editBtn = document.getElementById("edit-btn");
        let saveBtn = document.getElementById("save-btn");
        let cancelBtn = document.getElementById("cancel-btn");

        let fieldsToEnable = [
            "pi-name", "pi-email", "pi-age",
            "gender-male", "gender-female", "gender-other"
        ];

        function toggleFields(enable) {
            fieldsToEnable.forEach(id => {
                let field = document.getElementById(id);
                if (field) {
                    if (field.type === "radio") {
                        field.disabled = !enable;
                    } else {
                        field.readOnly = !enable;
                    }
                }
            });

            // ✅ Syncfusion Dropdown Readonly/Enable Logic
            let maritalDropdown = document.getElementById("pi-matstat").ej2_instances[0];
            if (maritalDropdown) {
                maritalDropdown.enabled = enable;
            }

            // ✅ Syncfusion DatePicker Readonly/Enable Logic
            let dobPicker = document.getElementById("pi-dob").ej2_instances[0];
            if (dobPicker) {
                dobPicker.enabled = enable; // Enable/Disable DatePicker
            }

            // ✅ Edit button hide/show logic
            editBtn.style.display = enable ? "none" : "inline-block";

            // ✅ Submit & Cancel buttons show/hide logic
            saveBtn.style.display = enable ? "inline-block" : "none";
            cancelBtn.style.display = enable ? "inline-block" : "none";
        }

        // Initially disable fields and hide Submit & Cancel buttons
        toggleFields(false);

        // Edit button event listener
        editBtn.addEventListener("click", function (event) {
            event.preventDefault();
            toggleFields(true);
        });

        // Cancel button event listener
        cancelBtn.addEventListener("click", function (event) {
            event.preventDefault();
            toggleFields(false);
        });
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $("#save-btn").click(function (e) {
            e.preventDefault();

            var isValid = true;

            // Function to show error messages
            function showError(inputId, message) {
                $("#" + inputId).closest(".col-md-6").find(".text-danger").text(message);
            }

            function clearError(inputId) {
                $("#" + inputId).closest(".col-md-6").find(".text-danger").text("");
            }

            // Validate Name
            if ($("#pi-name").val().trim() === "") {
                showError("pi-name", "Name is required.");
                isValid = false;
            } else {
                clearError("pi-name");
            }

            // Validate Phone Number
            if ($("#pi-phoneno").val().trim() === "") {
                showError("pi-phoneno", "Phone Number is required.");
                isValid = false;
            } else {
                clearError("pi-phoneno");
            }

           var email = $("#pi-email").val().trim();
            var emailRegex = /^[\w\.-]+@@[\w\.-]+\.\w+$/; // ✅ Regex for valid email format
            if (email === "") {
                showError("pi-email", "Email is required.");
                isValid = false;
            } else if (!emailRegex.test(email)) {
                showError("pi-email", "Invalid email address.");
                isValid = false;
            } else {
                clearError("pi-email");
            }

            // Validate Age
            if ($("#pi-age").val().trim() === "") {
                showError("pi-age", "Age is required.");
                isValid = false;
            } else {
                clearError("pi-age");
            }

            // Validate Date of Birth
            if ($("#pi-dob").val().trim() === "") {
                showError("pi-dob", "Date of Birth is required.");
                isValid = false;
            } else {
                clearError("pi-dob");
            }

            // Validate Marital Status
            if ($("#pi-matstat").val() === null || $("#pi-matstat").val() === "") {
                showError("pi-matstat", "Marital Status is required.");
                isValid = false;
            } else {
                clearError("pi-matstat");
            }

            // If any validation fails, stop AJAX request
            if (!isValid) {
                return;
            }
            var genderMapping = {
                "gender-male": "Male",
                "gender-female": "Female",
                "gender-other": "Other"
            };

            var selectedGenderId = $("input[name='gender']:checked").attr("id");
            var selectedGender = genderMapping[selectedGenderId] || "";
            var formData = {
                Name: $("#pi-name").val(),
                Id: $("#PatientId").val(),
                Email: $("#pi-email").val(),
                Age: $("#pi-age").val(),
                Dob: $("#pi-dob").val(),
                Gender: selectedGender, // Get selected gender
                MaritalStatus: $("#pi-matstat").val()
            };

            $.ajax({
                url: "/Index?handler=SavePatient",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(formData),
                success: function (response) {
                    toastr.success("Patient details saved successfully!");
                    setTimeout(function () {
                        location.reload();
                    }, 2000); // Reload after 2 seconds
                },
                error: function (xhr) {
                    alert("Error: " + xhr.responseText);
                }
            });
        });
    });
</script>


<script>
    function onLoad() {
        this.dataSource.dataSource.headers = [{ 'XSRF-TOKEN': $("input:hidden[name='__RequestVerificationToken']").val() }];
    }

    function toolbarClick(args) {
        debugger;

        if (args.item.id === 'GridLeave_excelexport') {
            this.excelExport({ hierarchyExportMode: "All", fileName: "Holidays.xlsx" });
        }
        if (args.item.id === 'GridLeave_resetlayout') {
            clearFilters('GridAppointments');
        }
        if (args.item.id === 'GridLeave_clearfilters') {
            var gridObj = document.getElementById('GridAppointments').ej2_instances[0];
            gridObj.searchModule.search("");
            gridObj.clearFiltering();
        }

    }

    function gridActionComplete() {
        updateGridUserPreference('GridAppointments');
    }
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        loadAppointments();
    });

    function loadAppointments() {
        $.ajax({
            url: '/Index?handler=AppointmentViewCard', // URL sahi daalein
            type: 'POST',
            contentType: 'application/json',
            success: function (response) {
                console.log(response); // Debugging ke liye

                var appointments = response.result;
                var container = $("#appointments-container");
                container.empty();

                $.each(appointments, function (index, appointment) {
                    console.log(appointment); // Check if appointment has correct data

                    var cardHtml = `
                        <div class="ius-gridrow">
                            <div class="ius-appbody">
                                <div class="ius-appinfo">
                                            <h3>${appointment.doctorName || 'N/A'}</h3>
                                    <div class="ius-apptyfo">
                                            <span class="appinfo-type">${appointment.appointmentType || 'N/A'}</span>
                                        <span class="appinfo-dot"></span>
                                            <span class="appinfo-form">${appointment.formOfAppointment || 'N/A'}</span>
                                    </div>
                                </div>
                                <div class="ius-ctrls">
                                    <a href="#app-resched" class="app-resched" title="Reschedule" data-bs-toggle="modal" data-bs-target="#app-resched">
                                                 <img loading="lazy" src="@Url.Content("~/assets/calendar.svg")" width="18" height="20" alt="Calendar">

                                    </a>
                                    <a href="#app-cancel" title="Cancel" data-bs-toggle="modal" data-bs-target="#app-cancel">
                                                    <img loading="lazy" src="@Url.Content("~/assets/delete.svg")" width = "18" height = "20" alt = "Cancel" >
                                    </a>
                                </div>
                            </div>
                            <div class="ius-foo">
                                <div class="ius-datetime">
                                    <div class="datetime-label text-sb">Date & Time</div>
                                        <div>${appointment.appointmentDateTime || 'N/A'}</div>
                                </div>
                                <div class="ius-status">
                                        <div class="ius-badge">${appointment.status || 'N/A'}</div>
                                </div>
                            </div>
                        </div>
                    `;
                    container.append(cardHtml);
                });
            },
            error: function (xhr, status, error) {
                console.error("Error fetching appointments: ", error);
            }
        });
    }

</script>
<style>
    span.e-input-group.e-control-wrapper.e-ddl.e-lib.e-keyboard.e-valid-input.e-disabled {
        background: #e9ecef !important;
        color: black !important;
    }

    .form-control:disabled, .form-control[readonly] {
        background-color: #e9ecef;
        opacity: 1;
        pointer-events: none !important;
    }

    span.e-input-group.e-control-wrapper.e-date-wrapper.e-valid-input.e-disabled {
        background-color: #e9ecef !important;
        color: black !important;
    }
</style>